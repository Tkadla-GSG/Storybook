import hello from 'hellojs';
import { type } from '../utils';
import ConfigurationComponent from './configurationComponent';

export default function FacebookComponent(configurationComponent) {
    type.check(configurationComponent, ConfigurationComponent);

    var initialized = false;

    return type.create(FacebookComponent, {
        login(options) {
            checkInitialized();

            return new Promise((resolve, reject) => {
                hello.login('facebook', options).then(
                    response => {
                        resolve(response.authResponse.access_token);
                    },
                    response => {
                        reject(response.error);
                    }
                );
            });
        },
    });

    function checkInitialized() {
        if (!initialized) {
            hello.init({ facebook: configurationComponent.getFacebookAppId() });
            initialized = true;
        }
    }
}
