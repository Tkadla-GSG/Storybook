'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = loadScript;

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function loadScript(url) {
    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref$async = _ref.async,
        async = _ref$async === undefined ? true : _ref$async;

    if (_lodash2.default.isArray(url)) {
        var promises = _lodash2.default.map(url, function (u) {
            return loadScript(u);
        });
        return Promise.all(promises);
    }

    return new Promise(function (resolve, reject) {
        var ready = false;
        var tag = document.getElementsByTagName('script')[0];
        var script = document.createElement('script');

        script.type = 'text/javascript';
        script.src = url;
        script.async = async;
        script.onload = script.onreadystatechange = function () {
            if (!ready && (!script.readyState || script.readyState === 'complete')) {
                ready = true;
                resolve(script);
            }
        };
        script.onerror = script.onabort = reject;
        tag.parentNode.insertBefore(script, tag);
    });
}